import{i as W,j as L,k as J,r as C,l as P,d as le,m as U,U as H,p as ie,R as de,q as ce,s as z,v as ue,H as d,a as c,c as f,y as _,z as b,u as t,b as e,f as w,t as a,g as T,A as me,T as x,G as B,F as K,x as pe,_ as fe,C as _e,B as ve,N as ye,E as be,n as he,a1 as Ce,S as ge}from"./index-60531247.js";import{_ as Ae,a as Te,b as Se}from"./EmptyResourceComponent-0b9922e9.js";import{_ as Ee}from"./pattern11-0e276dd2.js";import{_ as He}from"./circle-9a6de994.js";const ke=W("transfer",()=>{const g=L(),S=J(),o="transfer",u=C([]),A=C(!1);function v(l){u.value=l}function h(l){A.value=l}async function r(){h(!1);try{const l=await P.get(`${o}`);v(l.data.data.transfers)}catch(l){console.error(l),g.handlePost(l.response)}h(!0)}async function M(l){try{g.setPost(!0);const m=await P.post(`${o}/create`,l),{transfer:p}=m.data.data;return v([p,...u.value]),g.handlePost(m),S.setUser(),!0}catch(m){return console.error(m),g.handlePost(m.response),!1}}return{loaded:A,transfers:u,fetchAll:r,createTransfer:M}}),Ue=W("transferSettings",()=>{const g=L(),S="transfer-settings",o=C(),u=C(!1);function A(r){o.value=r}function v(r){u.value=r}async function h(){v(!1);try{const r=await P.get(`${S}`);A(r.data.data.transferSettings)}catch(r){console.error(r),g.handlePost(r.response)}v(!0)}return{loaded:u,transferSettings:o,fetch:h}}),Ne={key:0},Re={class:"row"},we={class:"col-xl-12 col-xxl-4"},xe={class:"card card-bx bg-blue action-card"},Be={class:"card-body text-white"},Pe={class:"row"},Le={class:"col-sm-6 col-xl-12 text-center"},Me={key:0,class:"text-white fs-36"},Fe={class:"text-num text-black fs-20 font-w500"},Ie={class:"col-sm-6 col-xl-12 text-center"},Oe={key:0,class:"text-white fs-36"},De={class:"text-num text-black fs-20 font-w500"},Ve={class:"d-flex justify-content-center mb-3"},$e={class:"col-xl-12 col-xxl-8"},qe={class:"card"},je={class:"card-body py-4"},Ye={class:"settings-form"},Ge={key:0,class:"row mt-4"},ze={class:"text-center"},Ke={class:"text-center"},We={class:"error-message"},Je={class:"row mt-4"},Qe={class:"mb-3 col-12"},Xe={class:"error-message"},Ze={class:"mb-3 col-12"},es={class:"d-flex justify-content-between"},ss={class:"d-flex gap-2"},ts={key:0,class:"d-flex"},ns={class:"fw-bold"},os={class:"error-message"},as={key:0,class:"card"},rs={class:"card-body"},ls={class:"row"},is={class:"offset-lg-2 col-lg-8"},ds={class:"mb-3"},cs=["value"],us={class:"mb-3"},ms=["value"],ps={class:"d-flex justify-content-center gap-3 mt-3"},fs={key:0,class:"row mt-4"},_s={class:"col-12"},vs={class:"card"},ys={class:"card-header"},bs={key:1,class:"card-body pt-0 px-0"},hs={class:"d-none"},Cs={class:"text-center"},gs=le({__name:"TransferPage",setup(g){const S=L(),o=J(),u=ke(),A=U(()=>u.transfers),v=U(()=>u.loaded);v.value||u.fetchAll();const h=Ue(),r=U(()=>h.transferSettings);U(()=>h.loaded).value||h.fetch();const l=C(0),m=n=>{scrollTo({top:0}),setTimeout(()=>{l.value=n},100)},p=C(H.MAIN_BALANCE),F=n=>p.value=n,E=C({account:p.value,amount:0,toUserUsername:""}),I=n=>{E.value=n},Q=n=>{S.setPost(!0),I(n),m(1),S.setPost(!1)},O=C(!1),N=n=>O.value=n,k=ie({status:de.INFO,title:"Confirming The Transfer",message:"By confirming, you have agreed that any mistake on the details you provided could lead to the money loss",onConfirm:()=>Z()}),X=ce({account:z().required("Account is required"),toUserUsername:z().required("Recipient username is required"),amount:ue().typeError("amount is required").min(0,"amount should not be a negative value").required("amount is required").test(function(n){if(o.user&&n+r.value.fee>o.user[p.value])throw this.createError({message:`You do not have sufficient balance in your ${d.fromCamelToTitleCase(p.value)} Account`});return!0})}),Z=async()=>{N(!1),await u.createTransfer(E.value)&&(I({account:H.MAIN_BALANCE,amount:0,toUserUsername:""}),m(2))};return(n,s)=>{const D=fe,ee=_e,R=ve,se=ye,te=Ae,ne=Se,oe=Te,ae=be;return c(),f(K,null,[_(x,{name:"slide"},{default:b(()=>[t(l)===0?(c(),f("div",Ne,[e("div",Re,[e("div",we,[e("div",xe,[s[14]||(s[14]=e("img",{class:"pattern-img",src:Ee,alt:""},null,-1)),e("div",Be,[s[13]||(s[13]=e("img",{src:He,class:"mb-4",alt:""},null,-1)),e("div",Pe,[e("div",Le,[t(o).user?(c(),f("h2",Me,[w(a(("Helpers"in n?n.Helpers:t(d)).toCurrency(t(o).user.mainBalance))+" ",1),s[9]||(s[9]=e("br",null,null,-1)),e("span",Fe,"≃ "+a(("Helpers"in n?n.Helpers:t(d)).toCrypto(t(o).user.mainBalance)),1)])):T("",!0),s[10]||(s[10]=e("p",{class:"fs-16"},"Main Balance",-1))]),e("div",Ie,[t(o).user?(c(),f("h2",Oe,[w(a(("Helpers"in n?n.Helpers:t(d)).toCurrency(t(o).user.referralBalance))+" ",1),s[11]||(s[11]=e("br",null,null,-1)),e("span",De,"≃ "+a(("Helpers"in n?n.Helpers:t(d)).toCrypto(t(o).user.referralBalance)),1)])):T("",!0),s[12]||(s[12]=e("p",{class:"fs-16"},"Referrals Balance",-1))])])])]),e("div",Ve,[e("a",{href:"javascript:void(0);",class:"btn btn-outline-secondary",onClick:s[0]||(s[0]=()=>m(2))},"View Transfer History")])]),e("div",$e,[e("div",qe,[e("div",je,[e("div",Ye,[_(se,{onSubmit:s[4]||(s[4]=y=>Q(y)),class:"custom-modal-content","validation-schema":t(X)},{default:b(({errors:y})=>[t(o).user?(c(),f("div",Ge,[s[17]||(s[17]=e("label",{class:"form-label"},"Account",-1)),_(ee,null,{default:b(()=>[_(D,{onClick:s[1]||(s[1]=()=>F(t(H).MAIN_BALANCE)),selected:t(p)===t(H).MAIN_BALANCE},{default:b(()=>[s[15]||(s[15]=e("span",{class:"d-block"},"Main Balance",-1)),e("h4",ze,a(("Helpers"in n?n.Helpers:t(d)).toCurrency(t(o).user.mainBalance)),1)]),_:1},8,["selected"]),_(D,{selected:t(p)===t(H).REFERRAL_BALANCE,onClick:s[2]||(s[2]=()=>F(t(H).REFERRAL_BALANCE))},{default:b(()=>[s[16]||(s[16]=e("span",{class:"d-block"},"Referral Balance",-1)),e("h4",Ke,a(("Helpers"in n?n.Helpers:t(d)).toCurrency(t(o).user.referralBalance)),1)]),_:1},8,["selected"])]),_:1}),_(R,{name:"account",modelValue:t(p),"onUpdate:modelValue":s[3]||(s[3]=i=>me(p)?p.value=i:null),type:"hidden"},null,8,["modelValue"]),e("span",We,a(y.account),1)])):T("",!0),e("div",Je,[e("div",Qe,[s[18]||(s[18]=e("label",{class:"form-label"},"Recipient Username",-1)),_(R,{name:"toUserUsername",type:"text",placeholder:"Recipient Username",class:"form-control","validate-on-input":!0,value:t(E).toUserUsername},null,8,["value"]),e("span",Xe,a(y.toUserUsername),1)]),e("div",Ze,[e("div",es,[s[20]||(s[20]=e("label",{class:"form-label"},"Amount",-1)),e("div",ss,[t(r)&&t(r).fee?(c(),f("div",ts,[s[19]||(s[19]=e("span",{class:""},"fee: ",-1)),e("span",ns,a(" "+t(r).fee),1)])):T("",!0)])]),_(R,{name:"amount",type:"number",placeholder:"Amount",class:"form-control","validate-on-input":!0,value:t(E).amount||""},null,8,["value"]),e("span",os,a(y.amount),1)]),s[21]||(s[21]=e("div",{class:"text-center mt-2"},[e("button",{class:"btn btn-primary",type:"submit"}," Pay Now ")],-1))])]),_:1},8,["validation-schema"])])])])])])])):T("",!0)]),_:1}),_(x,{name:"slide"},{default:b(()=>[t(l)===1?(c(),f("div",as,[s[25]||(s[25]=e("div",{class:"card-header"},[e("h4",{class:"card-title"},"Proceed Transfer")],-1)),e("div",rs,[s[24]||(s[24]=e("p",{class:"fs-18 text-center mx-auto mb-4",style:{"max-width":"490px"}}," PLEASE CHECK AND CONFIRM THE DETAILS YOU'VE ENTERED ARE CORRECT TO PROCEED, ANY MISTAKE COULD LEAD TO COIN LOSS WHICH MAY NOT BE REVERSED. ",-1)),e("div",ls,[e("div",is,[e("div",ds,[s[22]||(s[22]=e("label",{class:"form-label"},"Recipient Username",-1)),e("input",{type:"text",placeholder:"Recipient Username",class:"form-control",value:t(E).toUserUsername,readonly:""},null,8,cs)]),e("div",us,[s[23]||(s[23]=e("label",{class:"form-label"},"Amount To Transfer",-1)),e("input",{type:"text",placeholder:"Amount",class:"form-control",value:("Helpers"in n?n.Helpers:t(d)).toCurrency(t(E).amount),readonly:""},null,8,ms)])])]),e("div",ps,[e("button",{class:"btn btn-secondary",onClick:s[5]||(s[5]=()=>m(0))}," Go Back "),e("button",{class:"btn btn-primary",onClick:s[6]||(s[6]=()=>N(!0))}," Confirm ")])])])):T("",!0)]),_:1}),_(x,{name:"slide"},{default:b(()=>{var y;return[t(l)===2?(c(),f("div",fs,[e("div",_s,[e("div",vs,[e("div",ys,[s[26]||(s[26]=e("h4",{class:"card-title"},"Transfer History",-1)),e("button",{class:"btn btn-outline-secondary",onClick:s[7]||(s[7]=()=>m(0))}," Transfer ")]),t(v)&&!((y=t(A))!=null&&y.length)?(c(),B(te,{key:0},{default:b(()=>s[27]||(s[27]=[w(" No Transfer Record Found ")])),_:1})):(c(),f("div",bs,[t(v)?(c(),B(oe,{key:1},{default:b(()=>[s[28]||(s[28]=e("thead",{class:"bg-background"},[e("tr",null,[e("th",{class:"text-sharp d-none"},"Sort"),e("th",{class:"text-sharp text-center"},"Status"),e("th",{class:"text-sharp"},"Amount"),e("th",{class:"text-sharp"},"Fee"),e("th",{class:"text-sharp"},"Sender"),e("th",{class:"text-sharp"},"Receiver"),e("th",{class:"text-sharp"},"Created"),e("th",{class:"text-sharp"},"Settled")])],-1)),e("tbody",null,[(c(!0),f(K,null,pe(t(A),(i,re)=>{var V,$,q,j,Y,G;return c(),f("tr",{key:i._id},[e("td",hs,a(re+1),1),e("td",Cs,[e("span",{class:he(`badge light badge-${("Helpers"in n?n.Helpers:t(d)).toStatus(i.status)}`)},a(("Helpers"in n?n.Helpers:t(d)).toTitleCase(i.status)),3)]),e("td",null,a(("Helpers"in n?n.Helpers:t(d)).toCurrency(i.amount)),1),e("td",null,a(i.fee?("Helpers"in n?n.Helpers:t(d)).toCurrency(-i.fee):"--"),1),e("td",null,a(((V=i.fromUser)==null?void 0:V._id)===(($=t(o).user)==null?void 0:$._id)?"Me":((q=i.fromUser)==null?void 0:q.username)||"Unknown"),1),e("td",null,a(((j=i.toUser)==null?void 0:j._id)===((Y=t(o).user)==null?void 0:Y._id)?"Me":((G=i.toUser)==null?void 0:G.username)||"Unknown"),1),e("td",null,a(("Helpers"in n?n.Helpers:t(d)).toNiceDate(i.createdAt)),1),e("td",null,a(i.status===("TransferStatus"in n?n.TransferStatus:t(Ce)).PENDING?"--":("Helpers"in n?n.Helpers:t(d)).toNiceDate(i.updatedAt)),1)])}),128))])]),_:1})):(c(),B(ne,{key:0,rows:8,cols:6}))]))])])])):T("",!0)]}),_:1}),_(ae,{"is-open":t(O),status:t(k).status,title:t(k).title,message:t(k).message,onConfirm:t(k).onConfirm,onClose:s[8]||(s[8]=y=>N(!1)),"confirm-btn-text":"Yes, Confirm"},null,8,["is-open","status","title","message","onConfirm"])],64)}}});const Hs=ge(gs,[["__scopeId","data-v-75992480"]]);export{Hs as default};
