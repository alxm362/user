import{d as Y,k as j,M as G,m as k,r as c,U as d,p as K,R as F,q as J,s as Q,v as W,H as _,a as A,c as h,b as n,F as L,x as X,u as t,y as r,z as p,t as i,A as R,g as Z,B as ee,_ as se,C as te,D as ne,E as oe,G as ae,n as le,P as M}from"./index-60531247.js";import{u as re,_ as ue}from"./investment.store-f57f62bd.js";const ie={class:"row"},me=["onClick","disabled"],ce={key:0,class:"row mt-4"},de={class:"text-center"},pe={class:"text-center"},fe={class:"error-message"},_e={class:"row mt-4"},Ae={class:"mb-3 col-12"},Ce={class:"d-flex justify-content-between"},ve={class:"d-flex gap-2"},be={class:"d-flex"},Ne={class:"fw-bold"},Ee={class:"d-flex"},he={class:"fw-bold"},Me={class:"error-message"},Ie=Y({__name:"PackagePlansPage",setup(Se){const m=j(),V=re(),C=G(),$=k(()=>C.plans);k(()=>C.loaded).value||C.fetchAll();const u=c(),f=c(),a=c(d.MAIN_BALANCE),S=s=>a.value=s,O=s=>u.value=s,g=c(!1),v=(s,e)=>{g.value=s,O(e)},y=c(!1),b=s=>y.value=s,l=K({status:F.INFO,title:"",message:"",onConfirm:()=>{}}),H=s=>{l.status=s.status,l.title=s.title,l.message=s.message,l.onConfirm=s.onConfirm},T=s=>{H({status:F.INFO,title:`You are about to purchase this miner with the sum of ${_.toCurrency(f.value||0)}`,message:"Click on the confirm button to confirm this purchase.",onConfirm:async()=>{b(!1),await V.createInvestment(s)&&v(!1)}}),b(!0)},q=J({account:Q().required("Account is required"),amount:W().typeError("amount is required").min(0,"amount should not be a negative value").required("amount is required").test(function(s){if(u.value&&s<u.value.minAmount)throw this.createError({message:`Amount must be at least ${u.value.minAmount}`});if(m.user&&s>m.user[a.value])throw this.createError({message:`You do not have sufficient balance in your ${_.fromCamelToTitleCase(a.value)} Account`});return!0})});return(s,e)=>{const x=ue,N=ee,P=se,U=te,z=ne,D=oe;return A(),h(L,null,[n("div",ie,[(A(!0),h(L,null,X(t($),o=>(A(),ae(x,{plan:o,key:o._id},{default:p(()=>[n("button",{onClick:()=>v(!0,o),type:"button",class:le(`btn btn-outline-secondary w-100 mt-3 ${o.status===("PlanStatus"in s?s.PlanStatus:t(M)).ON_MAINTENANCE?"border-0":""}`),disabled:o.status===("PlanStatus"in s?s.PlanStatus:t(M)).ON_MAINTENANCE},i(o.status===("PlanStatus"in s?s.PlanStatus:t(M)).ON_MAINTENANCE?"Engine is on maintenance":"Invest"),11,me)]),_:2},1032,["plan"]))),128))]),r(z,{"is-open":t(g),"validation-schema":t(q),onConfirm:T,onClose:e[4]||(e[4]=()=>v(!1)),"confirm-btn-text":"Invest"},{default:p(({errors:o})=>{var I,B,w;return[e[12]||(e[12]=n("h3",{class:"border-bottom text-dark text-center pb-3"},"MAKE INVESTMENT",-1)),r(N,{name:"planId",value:(I=t(u))==null?void 0:I._id,type:"hidden"},null,8,["value"]),t(m).user?(A(),h("div",ce,[e[8]||(e[8]=n("label",{class:"form-label"},"Account",-1)),r(U,null,{default:p(()=>[r(P,{onClick:e[0]||(e[0]=()=>S(t(d).MAIN_BALANCE)),selected:t(a)===t(d).MAIN_BALANCE},{default:p(()=>[e[6]||(e[6]=n("span",{class:"d-block"},"Main Balance",-1)),n("h4",de,i(("Helpers"in s?s.Helpers:t(_)).toCurrency(t(m).user.mainBalance)),1)]),_:1},8,["selected"]),r(P,{selected:t(a)===t(d).REFERRAL_BALANCE,onClick:e[1]||(e[1]=()=>S(t(d).REFERRAL_BALANCE))},{default:p(()=>[e[7]||(e[7]=n("span",{class:"d-block"},"Referral Balance",-1)),n("h4",pe,i(("Helpers"in s?s.Helpers:t(_)).toCurrency(t(m).user.referralBalance)),1)]),_:1},8,["selected"])]),_:1}),r(N,{name:"account",modelValue:t(a),"onUpdate:modelValue":e[2]||(e[2]=E=>R(a)?a.value=E:null),type:"hidden"},null,8,["modelValue"]),n("span",fe,i(o.account),1)])):Z("",!0),n("div",_e,[n("div",Ae,[n("div",Ce,[e[11]||(e[11]=n("label",{class:"form-label"},"Amount",-1)),n("div",ve,[n("div",be,[e[9]||(e[9]=n("span",{class:""},"min: ",-1)),n("span",Ne,i(" "+((B=t(u))==null?void 0:B.minAmount)),1)]),n("div",Ee,[e[10]||(e[10]=n("span",{class:""},"max: ",-1)),n("span",he,i(" "+((w=t(u))==null?void 0:w.maxAmount)),1)])])]),r(N,{name:"amount",type:"number",placeholder:"Amount",class:"form-control",modelValue:t(f),"onUpdate:modelValue":e[3]||(e[3]=E=>R(f)?f.value=E:null),"validate-on-input":!0},null,8,["modelValue"]),n("span",Me,i(o.amount),1)])])]}),_:1},8,["is-open","validation-schema"]),r(D,{"is-open":t(y),status:t(l).status,title:t(l).title,message:t(l).message,onConfirm:t(l).onConfirm,onClose:e[5]||(e[5]=()=>b(!1))},null,8,["is-open","status","title","message","onConfirm"])],64)}}});export{Ie as default};
